[tasks.build_web]
dependencies = ["bundle"]

[tasks.bundle]
script_runner = "@shell"
script = ["npx rollup ./index.js --format iife --file ./bundle.js"]
dependencies = ["wasm_pack_build"]

[tasks.wasm_pack_build]
command = "wasm-pack"
args = ["build", "--target", "web", "--", "-j", "4"]

[tasks.export]
script_runner = "@shell"
script = '''
rm -rf export
mkdir export
mkdir export/pkg
cp ./index.html export
cp ./index.css export
cp ./bundle.js export
cp ./pkg/serde_web_converter_bg.wasm export/pkg
'''
dependencies = ["bundle"]